(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{357:function(t,s,e){"use strict";e.r(s);var n=e(42),a=Object(n.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"采坑日记"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#采坑日记"}},[t._v("#")]),t._v(" 采坑日记")]),t._v(" "),e("h2",{attrs:{id:"django-url模块加载时机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#django-url模块加载时机"}},[t._v("#")]),t._v(" Django url模块加载时机")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" django"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shortcuts "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" render\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" django"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" reverse\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" django"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shortcuts "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" redirect\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 试图在这里获取URL")]),t._v("\npage "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" reverse"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myapp:index'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" render"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myapp/index.html'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("re_index")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 然后在这里重定向")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" redirect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("page"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 报错信息：")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# django.core.exceptions.ImproperlyConfigured: ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The included URLconf 'mysite.urls' does not appear to have any patterns in it. ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# If you see valid patterns in the file then the issue is probably caused by a circular import.")]),t._v("\n")])])]),e("p",[t._v("Django官方文档：")]),t._v(" "),e("blockquote",[e("h2",{attrs:{id:"django-如何处理一个请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#django-如何处理一个请求"}},[t._v("#")]),t._v(" Django 如何处理一个请求")]),t._v(" "),e("p",[t._v("当一个用户请求Django 站点的一个页面，下面是Django 系统决定执行哪个Python 代码使用的算法：")]),t._v(" "),e("ol",[e("li",[t._v("Django 确定使用根 URLconf 模块。通常，这是 "),e("RouterLink",{attrs:{to:"/ref/settings.html#std:setting-ROOT_URLCONF"}},[e("code",[t._v("ROOT_URLCONF")])]),t._v(" 设置的值，但如果传入 "),e("code",[t._v("HttpRequest")]),t._v(" 对象拥有 "),e("RouterLink",{attrs:{to:"/ref/request-response.html#django.http.HttpRequest.urlconf"}},[e("code",[t._v("urlconf")])]),t._v(" 属性（通过中间件设置），它的值将被用来代替 "),e("RouterLink",{attrs:{to:"/ref/settings.html#std:setting-ROOT_URLCONF"}},[e("code",[t._v("ROOT_URLCONF")])]),t._v(" 设置。")],1),t._v(" "),e("li",[t._v("Django 加载该 Python 模块并寻找可用的 "),e("code",[t._v("urlpatterns")]),t._v(" 。它是 "),e("RouterLink",{attrs:{to:"/ref/urls.html#django.urls.path"}},[e("code",[t._v("django.urls.path()")])]),t._v(" 和(或) "),e("RouterLink",{attrs:{to:"/ref/urls.html#django.urls.re_path"}},[e("code",[t._v("django.urls.re_path()")])]),t._v(" 实例的序列("),e("a",{attrs:{href:"https://docs.python.org/3/glossary.html#term-sequence",target:"_blank",rel:"noopener noreferrer"}},[t._v("sequence"),e("OutboundLink")],1),t._v(")。")],1),t._v(" "),e("li",[t._v("Django 依次匹配每个URL 模式，在与请求的URL 匹配的第一个模式停下来。")]),t._v(" "),e("li",[t._v("一旦有 URL 匹配成功，Djagno 导入并调用相关的视图，这个视图是一个简单的 Python 函数（或基于类的视图class-based view）。视图会获得如下参数：\n"),e("ul",[e("li",[t._v("一个 "),e("RouterLink",{attrs:{to:"/ref/request-response.html#django.http.HttpRequest"}},[e("code",[t._v("HttpRequest")])]),t._v(" 实例。")],1),t._v(" "),e("li",[t._v("如果匹配的 URL返回没有命名组，那么来自正则表达式中的匹配项将作为位置参数提供。")]),t._v(" "),e("li",[t._v("关键字参数由路径表达式匹配的任何命名部分组成，并由 "),e("RouterLink",{attrs:{to:"/ref/urls.html#django.urls.path"}},[e("code",[t._v("django.urls.path()")])]),t._v(" 或 "),e("RouterLink",{attrs:{to:"/ref/urls.html#django.urls.re_path"}},[e("code",[t._v("django.urls.re_path()")])]),t._v(" 的可选 "),e("code",[t._v("kwargs")]),t._v(" 参数中指定的任何参数覆盖。")],1)])]),t._v(" "),e("li",[t._v("如果没有 URL 被匹配，或者匹配过程中出现了异常，Django 会调用一个适当的错误处理视图。参加下面的错误处理( "),e("a",{attrs:{href:"#error-handling"}},[t._v("Error handling")]),t._v(" )。")])])]),t._v(" "),e("p",[t._v("这里重点在于：")]),t._v(" "),e("p",[t._v("只有当用户发起请求的时候，Django才会加载"),e("code",[t._v("ROOT_URLCONF")]),t._v("并寻找可用的urlpatterns。")]),t._v(" "),e("p",[t._v("所以代码中的问题是：")]),t._v(" "),e("p",[t._v("执行reverse的时候并没有用户发起请求，因而没有加载url模块，导致无法找到相应的URL。")])])}),[],!1,null,null,null);s.default=a.exports}}]);