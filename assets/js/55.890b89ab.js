(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{403:function(t,s,a){"use strict";a.r(s);var e=a(42),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("​")]),t._v(" "),a("h1",{attrs:{id:"location处理指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#location处理指令"}},[t._v("#")]),t._v(" Location处理指令")]),t._v(" "),a("h2",{attrs:{id:"root和index"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#root和index"}},[t._v("#")]),t._v(" root和index")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  root /usr/share/nginx/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  index index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[t._v("root定义页面的根目录")])]),t._v(" "),a("li",[a("p",[t._v("匹配到的路径将被解释为目录的文件路径")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("http://xxx/user.html    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   /usr/share/nginx/html/user.html\n")])])])]),t._v(" "),a("li",[a("p",[t._v("index定义路径位置指向目录，比如"),a("code",[t._v("/base/")]),t._v("，后面多一个'/'代表目录（没有指向任何目录下文件时）默认使用的文件")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("http://xxx/base/    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /usr/share/nginx/html/base/index.html\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"try-files"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#try-files"}},[t._v("#")]),t._v(" try_files")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\troot /usr/share/nginx/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ttry_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[t._v("try_files用于返回指定文件，至少要有两个参数，最后一个参数为文件寻找失败之后重定向的路径，前面的参数全部为root下的文件路径。")])]),t._v(" "),a("li",[a("p",[t._v("文件路径参数如果最后没有"),a("code",[t._v("/")]),t._v("表示是文件路径，如果后面有"),a("code",[t._v("/")]),t._v("则表示目录路径，默认会返回该目录下的index.html。")])]),t._v(" "),a("li",[a("p",[t._v("有了"),a("code",[t._v("try_files")]),t._v("参数后"),a("code",[t._v("index")]),t._v("参数会失效。")])]),t._v(" "),a("li",[a("p",[t._v("可以填入$uri表示当前匹配的路径,参数"),a("code",[t._v("$uri")]),t._v("后面没有"),a("code",[t._v("/")]),t._v("则表示文件，即便"),a("code",[t._v("$uri")]),t._v("自己有"),a("code",[t._v("/")]),t._v("如"),a("code",[t._v("/base/user/")]),t._v("这种也表示文件。")])]),t._v(" "),a("li",[a("p",[t._v("为了兼容"),a("code",[t._v("$uri/")]),t._v("这种情况（因为"),a("code",[t._v("$uri")]),t._v("里面可能也有"),a("code",[t._v("/")]),t._v(")，如果我们要指定一个目录路径，则需要添加"),a("code",[t._v("//")]),t._v("才可以，比如"),a("code",[t._v("/alias//")]),t._v("才能返回从"),a("code",[t._v("/usr/share/nginx/html/alias/index.html")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("$uri表示"),a("code",[t._v("http://localhost:8000/base/index.html")]),t._v("的"),a("code",[t._v("/base/index.html")]),t._v("部分。")])]),t._v(" "),a("li",[a("p",[t._v("try_files 最后一个参数为重定向的路径，如果没有匹配到文件则重定向至"),a("code",[t._v("http://localhost:8000/index.html")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("try_files 最后一个参数也可以是"),a("code",[t._v("=code")]),t._v("这种形式，表示如果没有找到文件则返回相应的状态码。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\troot /usr/share/nginx/html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ttry_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果没有找到文件则返回500状态码")]),t._v("\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"proxy-pass"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy-pass"}},[t._v("#")]),t._v(" proxy_pass")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("location /base "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  proxy_pass http://12.34.56.78:8000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n// http://xxx/base/user\n")])])]),a("ul",[a("li",[a("p",[t._v("proxy_pass 后面的地址没有路径部分时，则将完整匹配路径传递给代理服务器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("http://12.34.56.78:8000/base/user\n")])])])])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("location /base "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  proxy_pass http://12.34.56.78:8000/other"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n// http://xxx/base/user\n")])])]),a("ul",[a("li",[a("p",[t._v("proxy_pass 后面的地址有路径部分时，则将路径中前缀后面的部分传递给代理服务器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("http://12.34.56.78:8000/other/user "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将 /user 凭借在代理服务器后面")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("通常当proxy_pass后面路径尾巴存在"),a("code",[t._v("/")]),t._v("时，location 后面的路径需要在尾巴后面也要添加一个"),a("code",[t._v("/")]),t._v("防止字符串拼接时出现两个"),a("code",[t._v("/")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("location /base/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  proxy_pass http://12.34.56.78:8000/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("对于正则匹配，proxy_pass后面不能有路径部分，否则会报错。")]),t._v(" 因为正则匹配不是严格的前缀匹配，路径没法切割。")])])]),t._v(" "),a("h2",{attrs:{id:"return"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#return"}},[t._v("#")]),t._v(" return")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("location / {\n\tdefault_type text/html;\n  return 200 'root';\n}\n")])])]),a("ul",[a("li",[t._v("return用于直接返回值")]),t._v(" "),a("li",[t._v("在有return存在的情况下，只会返回return后面的值")])])])}),[],!1,null,null,null);s.default=r.exports}}]);